

<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ğ‹ğšğ©ğ¨ğ«ğšğ§ ğğğ§ğ ğğ¥ğ®ğšğ«ğšğ§ ğŠğğ®ğšğ§ğ ğšğ§</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
/* ===== ROBOT TABLE ===== */
.table{
  background:#050b10;
  color:#e8ffff;
  border-collapse:separate;
  border-spacing:0 6px;
  font-family:'Orbitron', monospace;
}

/* HEADER */
.table thead th{
  background:linear-gradient(90deg,#021217,#042b2f);
  color:#00ffe1;
  text-transform:uppercase;
  letter-spacing:1px;
  font-size:12px;
  border:none;
  padding:12px;
  box-shadow:inset 0 -2px 0 rgba(0,255,225,.4);
}

/* ROW */
.table tbody tr{
  background:linear-gradient(145deg,#060d12,#02070b);
  border:1px solid rgba(0,255,225,.2);
  box-shadow:
    0 0 8px rgba(0,255,225,.15),
    inset 0 0 6px rgba(0,255,225,.08);
  transition:.3s;
}

/* HOVER EFFECT */
.table tbody tr:hover{
  transform:scale(1.01);
  box-shadow:
    0 0 20px rgba(0,255,225,.5);
}

/* CELL */
.table td{
  border:none;
  padding:10px;
  font-size:13px;
}

/* SALDO COLUMN */
.table td:nth-child(6){
  color:#00ff88;
  font-weight:600;
  text-shadow:0 0 6px rgba(0,255,136,.6);
}

/* CHECKBOX */
.table input[type="checkbox"]{
  accent-color:#00ffe1;
  transform:scale(1.2);
}

/* ACTION BUTTON */
.table .btn-danger{
  background:transparent;
  border:1px solid #ff3b3b;
  color:#ff3b3b;
  box-shadow:0 0 8px rgba(255,59,59,.4);
}

.table .btn-danger:hover{
  background:#ff3b3b;
  color:#000;
}

/* SCAN LINE EFFECT */
.table tbody tr::after{
  content:"";
  position:absolute;
  left:0;
  right:0;
  height:2px;
  background:linear-gradient(90deg,transparent,#00ffe1,transparent);
  opacity:.15;
  animation:scanline 3s linear infinite;
}

@keyframes scanline{
  0%{top:0}
  100%{top:100%}
}
</style>

</head>
<body class="p-3">

<div class="container">

<h4 class="mb-4 fw-bold">ğ‹ğšğ©ğ¨ğ«ğšğ§ ğğğ§ğ ğğ¥ğ®ğšğ«ğšğ§ ğŠğğ®ğšğ§ğ ğšğ§</h4>

<!-- CARD INFO -->
<div class="row g-3 mb-4">
  <div class="col-6">
    <div class="card card-soft p-3">
      <small>ğ“ğ¨ğ­ğšğ¥ ğ’ğšğ¥ğğ¨</small>
      <h5 id="totalSaldo" class="fw-bold">Rp 0</h5>
    </div>
  </div>
  <div class="col-6">
    <div class="card card-soft p-3">
      <small>ğ‰ğ®ğ¦ğ¥ğšğ¡ ğ„ğ§ğ­ğ«ğ¢</small>
      <h5 id="totalEntri" class="fw-bold">0</h5>
    </div>
  </div>
</div>
<!-- FORM INPUT -->
<div class="card card-soft p-3 mb-4">
  <div class="row g-2">
    <div class="col-md-3">
      <input type="date" id="tanggal" class="form-control">
    </div>
    <div class="col-md-3">
      <input type="text" id="keterangan" class="form-control" placeholder="Keterangan">
    </div>
    <div class="col-md-2">
      <input type="number" id="debit" class="form-control" placeholder="Debit">
    </div>
    <div class="col-md-2">
      <input type="number" id="credit" class="form-control" placeholder="Credit">
    </div>
    <div class="col-md-2 d-grid">
      <button onclick="simpanData()" class="btn btn-primary">ğ“ğšğ¦ğ›ğšğ¡</button>
    </div>
  </div>
</div>
<button onclick="hapusDipilih()" class="btn btn-warning btn-sm mt-3">Hapus yang Dipilih</button>
<button onclick="resetAll()" class="btn btn-danger btn-sm mt-3">Reset All</button>
<!-- TABEL -->
<div class="card card-soft p-3">
<table class="table align-middle">
<thead>
<tr>
  <th>Pilih</th>
  <th>Tanggal</th>
  <th>Keterangan</th>
  <th>Debit</th>
  <th>Credit</th>
  <th>Total Saldo</th>
  <th>Aksi</th>
</tr>
</thead>
<tbody id="tabelData"></tbody>
</table>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, getDocs, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";


const firebaseConfig = {
  apiKey: "AIzaSyCHhmNaNC7pImRHUrEjCdLrHvdReRTe-hA",
  authDomain: "game-59094.firebaseapp.com",
  projectId: "game-59094",
  storageBucket: "game-59094.firebasestorage.app",
  messagingSenderId: "239664999702",
  appId: "1:239664999702:web:85332e013a7b01476df437",
  measurementId: "G-KHJEQCWD7J"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const colRef = collection(db, "keuangan");

const tanggal = document.getElementById("tanggal");
const keterangan = document.getElementById("keterangan");
const debit = document.getElementById("debit");
const credit = document.getElementById("credit");
const tabelData = document.getElementById("tabelData");
const totalSaldo = document.getElementById("totalSaldo");
const totalEntri = document.getElementById("totalEntri");

window.simpanData = async () => {
  if (!tanggal.value || !keterangan.value) {
    alert("Tanggal dan keterangan wajib diisi");
    return;
  }

  await addDoc(colRef, {
    tanggal: tanggal.value,
    keterangan: keterangan.value,
    debit: Number(debit.value || 0),
    credit: Number(credit.value || 0)
  });

  tanggal.value = "";
  keterangan.value = "";
  debit.value = "";
  credit.value = "";
};

onSnapshot(colRef, (snap) => {
  tabelData.innerHTML = "";
  let saldo = 0;
  let total = 0;

  snap.forEach(docSnap => {
    const d = docSnap.data();
    const id = docSnap.id;

    saldo += d.debit - d.credit;
    total++;

    tabelData.innerHTML += `
      <tr>
        <td>
          <input type="checkbox" class="pilihData" value="${id}">
        </td>
        <td>${d.tanggal}</td>
        <td>${d.keterangan}</td>
        <td>Rp ${d.debit.toLocaleString()}</td>
        <td>Rp ${d.credit.toLocaleString()}</td>
        <td>Rp ${saldo.toLocaleString()}</td>
        <td>
          <button class="btn btn-danger btn-sm" 
            onclick="hapusSatu('${id}')">
            Hapus
          </button>
        </td>
      </tr>
    `;
  });

  totalSaldo.innerText = "Rp " + saldo.toLocaleString();
  totalEntri.innerText = total;
});
window.hapusSatu = async (id) => {
  if (!confirm("Hapus data ini?")) return;
  await deleteDoc(doc(db, "keuangan", id));
};
window.hapusDipilih = async () => {
  const checked = document.querySelectorAll(".pilihData:checked");
  if (checked.length === 0) {
    alert("Pilih data terlebih dahulu");
    return;
  }

  if (!confirm("Hapus data yang dipilih?")) return;

  for (let cb of checked) {
    await deleteDoc(doc(db, "keuangan", cb.value));
  }
};

window.resetAll = async () => {
  if (!confirm("Hapus semua data?")) return;
  const docs = await getDocs(colRef);
  docs.forEach(d => deleteDoc(d.ref));
};
</script>

</body>
</html>
